<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<!--### template ###-->
<!-- InquiryForm -->
<template id="caseTemplate">
	<dl>
		<a class="inq-id" href="javascript:void(0)" onclick="inquiryDetailScreenTransition(this.dataset.cId)" data-cId="">
			<dt class="inq-title"></dt>
			<dd>
				<div id="caseContent" class="inq-outputNew list-qa-box">
					<p class="list-qa-cont cbd-content"></p>
						<p class="list-qa-ic">NEW</p>
				</div>
				<p class="list-qa-time inq-createdate"></p>
				<p class="list-qa-txt">
					<span>お問い合わせ種類</span>
					<span class="inq-type"></span>
				</p>
				<p class="list-qa-txt">
					<span>ステータス</span>
					<span class="txt-not-fin inq-status"></span>
				</p>
			</dd>
		</a>
	</dl>
</template>

<!-- cbdTemplate -->
<template id="cbdTemplate">
	<div class="contbrd-cont">
		<div class="contbrd-head">
			<dl>
			<dt>
				<span class="actor-text"></span>
				<span class="new-icon">NEW</span>
			</dt>
			<dd class="createddate"></dd>
			</dl>
		</div>
		<div class="contbrd-body">
			<div id="" name="cbdId" class="contbrd-txt">
				<p class="contbrd-content"></p>
			</div>
		</div>
	</div>
</template>

<!-- fileTemplate -->
<template id="fileTemplate">
	<p><a class="fileLink" target="_blank"></a></p>
</template>

<!-- uploadFileTemplate -->
<template id="fileUpTemplate">
	<p class="upfile-text"><a target="_blank"></a><span class="InputClear inputClear">×</span></p>
</template>

<script type="text/javascript">
<!--
	// 通信先URL　※環境に併せて変更する必要あり！
	const REQUEST_DOMAIN = 'https://paypay-bank--pt49.sandbox.my.salesforce.com';
	const CLIENT_ID = '3MVG99S6MzYiT5k.KkcZzmtcXubr_J8l8N8473VR.oFizQeVyWXFV5ARIiXmwhmXqjuNU.K6Pk9mc9M3btLBQ';
	const REFLESH_TOKEN = '5Aep861hjC52juQoBcsFRsbEALR2k2PEkuCJTzezJjsxYDFcfM3Xu_8fN.OBDlZ6BJFv9GwwXc8hH5doNmlIiVu';
	
	// 通信処理結果を退避するための変数
	let res;
	// 連携用文字列
	let linkedStr;
	// メールアドレス
	let eMail;
	// ファイルアップロード用ファイル
	let inputFiles = new Array();
	// アップロードファイル操作用：選択Index
	let selectFileIndex;
	// アップロードファイル操作用：アップロード済ファイルサイズ
	let uploadedFileSize = 0;
	// エラーメッセージ（モーダル）
	let errorMessageText;
	// エラー格納用
	let errorInfo = {
		data: '', // データ
		errorThrown: '', // 例外情報
		status: '' // エラー情報
	};
	// 新規投稿用データハッシュ
	const inqRegistData = {
		EncryptedData:null,
		Subject:null,
		Content:null,
		LinkedDial:null
	};
	// 追加投稿用データハッシュ
	const cbdRegistData = {
		EncryptedData:null,
		CaseId:null,	
		Content:null
	};
	// 画面ID
	const screenNameList = [
		'inquiryForm',
		'noInq',
		'detailsScreen',
		'inqInputScreen',
		'inqConfirmScreen',
		'replyInputScreen',
		'replyConfirmScreen',
		'compScreen'
	];
	// 各種手続きダイヤル設定対象
	const procedureDialList = [
		'登録情報の変更', 
		'キャッシュカード・トークン', 
		'振込', 
		'口座自動振替', 
		'各種証明書（取引明細・残高証明など）'
	];
	// 拡張子のリスト
	const extensionList = ["heic", "xls", "xlsx", "doc", "docx", "png", "jpg", "jpeg", "pdf"];
	
	/**
	 * 初期表示処理
	 */
	$(function(){
		// 連携文字列取得
		//linkedStr = $('input[name="SFConnectParam"]').val();
		//linkedStr = 'bd1fcec2a09397bdac42bdba68beca74a28e90a646bffae6d0b2f3a376aa9993'; //いっぱい
		linkedStr = 'b0d9fb640d1619065677920ae3734436346a058da071975e0df730ab6da7a43c' // ケース0件
		// ホーム画面を表示
		changeDisp('inquiryForm');
		
		//モーダル開閉
		$(".ModalBtn").on("click", function(){
			$(".modalOverlay,.modalWrap").fadeIn();
			$("body").css({position:"fixed",top:-1});
			selectId = $(this).attr("id").slice(6);
		});
		
		$(".modal__bottomArea").on("click", function(){
			$(".modalOverlay,.modalWrap").fadeOut();
			$("body").css({position:"",top:0});
			SelectRadio(selectId);
		});
		$(".x-data-inqType").change(function(){
			SelectRadio(selectId);
		});
		//モーダル開閉　戻る、ログアウト時
		$(".prevBtn, .logout").on("click", function(){
			if ($("body").find(".data-on").length) {
				var CurrentScrollY = $(window).scrollTop();
				$(".modalOverlay,.modalWrap_error.error-type1").fadeIn();
				$("body").css({position:"fixed",top:-1 * CurrentScrollY});
			}else{
			}
		});
		$(".textinput-box .InputClear").on("click", function(){
			if ($("body").find(".data-on").length) {
				var CurrentScrollY = $(window).scrollTop();
				$(".modalOverlay,.modalWrap_error.error-type2").fadeIn();
				$("body").css({position:"fixed",top:-1 * CurrentScrollY});
			}else{
			}
		});
		$(".upfile-text .InputClear").on("click", function(){
			var CurrentScrollY = $(window).scrollTop();
			$(".modalOverlay,.modalWrap_error.error-type3").fadeIn();
			$("body").css({position:"fixed",top:-1 * CurrentScrollY});
		});
		$(".modal__close").on("click", function(){
			var CurrentScrollY = $(window).scrollTop();
			$(".modalOverlay,.modalWrap_error").fadeOut();
			$("body").css({position:"",top:0 * CurrentScrollY});
		});
		//入力値クリア
		$(".InputClear").on("click", function(){
			if ($("body").find(".data-on").length) {
				var CurrentScrollY = $(window).scrollTop();
				$(".modalOverlay,.modalWrap_error.error-type2").fadeIn();
				$("body").css({position:"fixed",top:-1 * CurrentScrollY});
				NextBtnActivity();
			}else{
			}
		});
		//input入力
		$("#inqTextInput").on("keydown keyup keypress change blur", function() {
			if ($(this).val().length) {
				$('#inqContentDel').css("opacity", 1);
				$("#inqTextInput").removeClass("reqEntry").addClass("data-on");
			}else{
				$('#inqContentDel').css("opacity", 0);
				$("#inqTextInput").addClass("reqEntry").removeClass("data-on");
			}
			NextBtnActivity();
		});
		$("#inqDelBtn").on({
			"click":function(){
				$('#inqTextInput').val("");
				inqReqCheck();
				if($('#inqTextInput').val() == ''){
					$('#inqTextInput').css('background', '#ffffcc');
				}
				$('#inqContentDel').css("opacity", 0);
				$("#inqTextInput").addClass("reqEntry").removeClass("data-on");
				//$("#inqtextInput").css({height:"42px"});
				NextBtnActivity();
			}
		});
		//入力時の下線制御
		//setReqCls("#Modal-inqType, #inqTextInput");
		
		//モーダル開閉
		$(".ModalBtn").on("click", function(){
			$(".modalOverlay,.modalWrap").fadeIn();
			$("body").css({position:"fixed",top:-1});
			selectId = $(this).attr("id").slice(6);
			//ModalOpen(selectId);
		});
		
		$(".modal__bottomArea").on("click", function(){
			$(".modalOverlay,.modalWrap").fadeOut();
			$("body").css({position:"",top:0});
			SelectRadio(selectId);
		});
		$(".x-data-inqType").change(function(){
			SelectRadio(selectId);
		});
		//モーダル開閉　戻る、ログアウト時
		$(".prevBtn, .logout").on("click", function(){
			if ($("body").find(".data-on").length) {
				var CurrentScrollY = $(window).scrollTop();
				$(".modalOverlay,.modalWrap_error.error-type1").fadeIn();
				$("body").css({position:"fixed",top:-1 * CurrentScrollY});
			}else{
			}
		});
		$(".textinput-box .InputClear").on("click", function(){
			if ($("body").find(".data-on").length) {
				var CurrentScrollY = $(window).scrollTop();
				$(".modalOverlay,.modalWrap_error.error-type2").fadeIn();
				$("body").css({position:"fixed",top:-1 * CurrentScrollY});
			}else{
			}
		});
		$(".upfile-text .InputClear").on("click", function(){
			var CurrentScrollY = $(window).scrollTop();
			$(".modalOverlay,.modalWrap_error.error-type3").fadeIn();
			$("body").css({position:"fixed",top:-1 * CurrentScrollY});
		});
		$(".modal__close").on("click", function(){
			var CurrentScrollY = $(window).scrollTop();
			$(".modalOverlay,.modalWrap_error").fadeOut();
			$("body").css({position:"",top:0 * CurrentScrollY});
		});
		//入力値クリア
		$(".InputClear").on("click", function(){
			if ($("body").find(".data-on").length) {
				var CurrentScrollY = $(window).scrollTop();
				$(".modalOverlay,.modalWrap_error.error-type2").fadeIn();
				$("body").css({position:"fixed",top:-1 * CurrentScrollY});
				NextBtnActivity();
			}else{
			}
		});
		//input入力
		$("#cbdTextInput").on("keydown keyup keypress change blur", function() {
			if ($(this).val().length) {
				$('#cbdContentDel').css("opacity", 1);
				$("#cbdTextInput").removeClass("reqEntry").addClass("data-on");
			}else{
				$('#cbdContentDel').css("opacity", 0);
				$("#cbdTextInput").addClass("reqEntry").removeClass("data-on");
			}
			NextBtnActivity();
		});
		$("#cbdDelBtn").on({
			"click":function(){
				$('#cbdTextInput').val("");
				cbdReqCheck();
				if($('#cbdTextInput').val() == ''){
					$('#cbdTextInput').css('background', '#ffffcc');
				}
				$('#cbdContentDel').css("opacity", 0);
				$("#cbdTextInput").addClass("reqEntry").removeClass("data-on");
				//$("#inqtextInput").css({height:"42px"});
				NextBtnActivity();
			}
		});
		//入力時の下線制御
		//setReqCls("#Modal-inqType, #cbdTextInput");
		
		$("#outputCbdTemp").on("click", ".contbrd-cont", function(){
			$(this).toggleClass("open");
		});
		
		/*** 確認するボタン活性処理 ***/
		// 必須項目に何か変更が加えられたら（＝入力されたら）、check関数が作動する
		$('#confButton').prop("disabled", true);
		
		$('#modalText').change( function(){
			inqReqCheck();
		});
		
		$('#inqTextInput').change(function(){
			inqReqCheck();
		});
		
		$('#cbdConfButton').prop("disabled", true);

		$('#cbdTextInput').change(function(){
			cbdReqCheck();
		});
		
		/*** 新規問い合わせ画面 入力欄の背景色を黄色にする ***/
		if($("#inqTextInput").val() == ''){
			// 黄色
			$("#inqTextInput").css('background', '#ffffcc');
		}
		$("#inqTextInput").on('keydown keyup keypress change focus blur', function() {
			// 値が空の時
			if($(this).val() == ''){
				// 黄色
				$(this).css('background', '#ffffcc');
			// 値が入っている時に白色
			}else{
				// 白色
				$(this).css('background', '');
			}
		});
		
		/*** 個別問い合わせ画面 入力欄の背景色を黄色にする ***/
		if($("#cbdTextInput").val() == ''){
			// 黄色
			$("#cbdTextInput").css('background', '#ffffcc');
		}
		
		$("#cbdTextInput").on('keydown keyup keypress change focus blur', function() {
			// 値が空の時
			if($(this).val() == ''){
				// 黄色
				$(this).css('background', '#ffffcc');
			// 値が入っている時に白色
			}else{
				// 白色
				$(this).css('background', '');				
			}
		});
		
		$(".contbrd-cont").click(function(){
			$(this).toggleClass("open");
		});

		/*** 追加モーダル処理 ***/
    	// モーダル閉じるボタン(画面遷移なし)
        $(".mClose").on("click", function(){
            var CurrentScrollY = $(window).scrollTop();
            $(".modalOverlay,.modalWrap_error").fadeOut();
            $(".modalWrap_error").css("display", "none");
            $("body").css({position:"",top:0 * CurrentScrollY});
        });
    
		// 削除ボタン押下時入力欄
		$('#inqDelbtn').click(function(){
			// 値が空の時
			if($("#inqTextInput").val() == ''){
				// 黄色
				$("#inqTextInput").css('background', '#ffffcc');
			// 値が入っている時に白色
			}else{
				// 白色
				$("#inqTextInput").css('background', '');
			}
		});
		
		// 削除ボタン押下時入力欄
		$('#cbdDelBtn').click(function(){
			// 値が空の時
			if($("#cbdTextInput").val() == ''){
				// 黄色
				$("#cbdTextInput").css('background', '#ffffcc');
			// 値が入っている時に白色
			}else{
				// 白色
				$("#cbdTextInput").css('background', '');
			}
		});
		
		//const jinkakuCode = $('input[name="JinkakuCode"]').val();
		const jinkakuCode = '個人';
		
		if(jinkakuCode){
			// 人格コードが個人または非居住者の場合
			if(jinkakuCode == '個人' || jinkakuCode == '非居住者'){
				// 個人用を表示
				document.getElementById('dial01').style.display = '';
				document.getElementById('dial02').style.display = '';
				document.getElementById('dial03').style.display = '';
				document.getElementById('dial04').style.display = '';
				document.getElementById('dial05').style.display = '';
				document.getElementById('dial06').style.display = '';
				// 法人用を非表示
				document.getElementById('dial07').style.display = 'none';
				document.getElementById('dial08').style.display = 'none';
				document.getElementById('dial09').style.display = 'none';
				document.getElementById('dial10').style.display = 'none';
				document.getElementById('dial11').style.display = 'none';
				document.getElementById('dial12').style.display = 'none';
				document.getElementById('dial13').style.display = 'none';
			}else{
				// 個人用を非表示
				document.getElementById('dial01').style.display = 'none';
				document.getElementById('dial02').style.display = 'none';
				document.getElementById('dial03').style.display = 'none';
				document.getElementById('dial04').style.display = 'none';
				document.getElementById('dial05').style.display = 'none';
				document.getElementById('dial06').style.display = 'none';
				// 法人用を表示
				document.getElementById('dial07').style.display = '';
				document.getElementById('dial08').style.display = '';
				document.getElementById('dial09').style.display = '';
				document.getElementById('dial10').style.display = '';
				document.getElementById('dial11').style.display = '';
				document.getElementById('dial12').style.display = '';
				document.getElementById('dial13').style.display = '';
			}
		}
		// ファイルアップロード時（新規投稿）
		$("#inqFileName").change(function(){
			// 警告表示のクリア
			$("#inqFileAlert").html(null);
			// ファイルアップロード用のInputを取得
			const elemFile = document.getElementById("inqFileName");
			// アップロード対象のファイルを取得
			const files = elemFile.files;
			// アップロードされるファイル数の取得
			selectFiles = files.length;
			// アップロード済のファイル数の取得
			existFiles = $("#inqFileList").children().length;
			// 合計5ファイルを超過している場合
			if(selectFiles + existFiles > 5){
				// 警告表示
				$("#inqFileAlert").text("ファイル数は5ファイル以内でアップロードしてください。");
				// 以後処理しない
				return;
			}
			// ファイルサイズ
			let fileSize = 0;
			// アップロードファイル分繰り返す
			for(let i = 0; i < files.length; i++){
				// 拡張子で区切る
				const extensionSplit = files[i].name.split(".");
				// 拡張子を取得
				const extension = extensionSplit[extensionSplit.length - 1];
				// 拡張子が規定のファイルでない場合
				if(extensionList.indexOf(extension) < 0){
					// 警告表示
					$("#inqFileAlert").html("以下のファイル形式のみアップロード可能です。<BR>.heic, .xls, .xlsx, .doc, .docx, .png, .jpg, .jpeg, .pdf");
					// 以後処理しない
					return;
				}
				// ファイルサイズを加算
				fileSize = files[i].size;
			}
			// アップロード済のファイルサイズとファイルサイズの合計が24MBを超える場合
			if(uploadedFileSize + fileSize > 24 * 1024 * 1024){
				// 警告表示
				$("#inqFileAlert").text("ファイルサイズは24MB以内でアップロードしてください。");
				// 以後処理しない
				return;
			}
			// アップロード済ファイルサイズにアップロードするファイルサイズを加算する
			uploadedFileSize += fileSize;
			// アップロードファイル分繰り返す
			for(let i = 0; i < files.length; i++){
				// ファイル表示用テンプレートをロード
				const fileUpTemplate = document.getElementById("fileUpTemplate");
				// クローンする
				const clone = fileUpTemplate.content.cloneNode(true);
				// ファイルパスをセパレータ分割
				const filePathList = files[i].name.split("\\");
				// ファイル出力対象のアンカー部分取得
				const anchor = clone.querySelector(".upfile-text").getElementsByTagName("a")[0];
				// ファイル名のみを反映				
				anchor.innerHTML = filePathList[filePathList.length - 1];
				// 遷移先をダウンロード用に設定
				anchor.href = URL.createObjectURL(files[i]);
				// ファイル名右の×ボタン押下時の処理
				$(clone.querySelector(".inputClear")).on("click", function(){
					// 画面表示位置の取得
					selectFileIndex = $(this.parentNode).prevAll().length;
					// 確認用ダイアログの表示
					$(".modalOverlay,.error-type3").fadeIn();
					$("body").css({position:"fixed",top:-1});
				});
				// 画面に反映
				$("#inqFileList").append(clone);
			}
			// 再帰呼び出しによるファイル読み取り
			recursiveFileRead(elemFile, files, 0);
		});
		// ファイルアップロード時（追加投稿）
		$("#cbdFileName").change(function(){
			// 警告表示のクリア
			$("#cbdFileAlert").html(null);
			// ファイルアップロード用のInputを取得
			const elemFile = document.getElementById("cbdFileName");
			// アップロード対象のファイルを取得
			const files = elemFile.files;
			// アップロードされるファイル数の取得
			selectFiles = files.length;
			// アップロード済のファイル数の取得
			existFiles = $("#cbdFileList").children().length;
			// 合計5ファイルを超過している場合
			if(selectFiles + existFiles > 5){
				// 警告表示
				$("#cbdFileAlert").text("ファイル数は5ファイル以内でアップロードしてください。");
				// 以後処理しない
				return;
			}
			// ファイルサイズ
			let fileSize = 0;
			// アップロードファイル分繰り返す
			for(let i = 0; i < files.length; i++){
				// 拡張子で区切る
				const extensionSplit = files[i].name.split(".");
				// 拡張子を取得
				const extension = extensionSplit[extensionSplit.length - 1];
				// 拡張子が規定のファイルでない場合
				if(extensionList.indexOf(extension) < 0){
					// 警告表示
					$("#cbdFileAlert").html("以下のファイル形式のみアップロード可能です。<BR>.heic, .xls, .xlsx, .doc, .docx, .png, .jpg, .jpeg, .pdf");
					// 以後処理しない
					return;
				}
				// ファイルサイズを加算
				fileSize = files[i].size;
			}
			// アップロード済のファイルサイズとファイルサイズの合計が24MBを超える場合
			if(uploadedFileSize + fileSize > 24 * 1024 * 1024){
				// 警告表示
				$("#cbdFileAlert").text("ファイルサイズは24MB以内でアップロードしてください。");
				// 以後処理しない
				return;
			}
			// アップロード済ファイルサイズにアップロードするファイルサイズを加算する
			uploadedFileSize += fileSize;
			// アップロードファイル分繰り返す
			for(let i = 0; i < files.length; i++){
				// ファイル表示用テンプレートをロード
				const fileUpTemplate = document.getElementById("fileUpTemplate");
				// クローンする
				const clone = fileUpTemplate.content.cloneNode(true);
				// ファイルパスをセパレータ分割
				const filePathList = files[i].name.split("\\");
				// ファイル出力対象のアンカー部分取得
				const anchor = clone.querySelector(".upfile-text").getElementsByTagName("a")[0];
				// ファイル名のみを反映				
				anchor.innerHTML = filePathList[filePathList.length - 1];
				// 遷移先をダウンロード用に設定
				anchor.href = URL.createObjectURL(files[i]);
				// ファイル名右の×ボタン押下時の処理
				$(clone.querySelector(".inputClear")).on("click", function(){
					// 画面表示位置の取得
					selectFileIndex = $(this.parentNode).prevAll().length;
					// 確認用ダイアログの表示
					$(".modalOverlay,.error-type3").fadeIn();
					$("body").css({position:"fixed",top:-1});
				});
				// 画面に反映
				$("#cbdFileList").append(clone);
			}
			// 再帰呼び出しによるファイル読み取り
			recursiveFileRead(elemFile, files, 0);
		});
		// AjaxによりSalesforceから表示データを取得
		getAllCase();
	});
	
	/**
	 * 初期処理
	 */
	function init(){
		// ファイルアップロード用ファイルをリセット
		inputFiles = new Array();
		// アップロード済ファイルサイズをリセット
		uploadedFileSize = 0;
		// RestApexとの通信時erorrだった場合にエラーのモーダルを表示する処理に変更する
		if(res.result == 'SUCCESS'){
			if(!res.caseList){ // お問い合わせ0件(null)の場合
				// ホーム画面（履歴なし）を表示
				changeDisp('noInq');
				return;
			}else{
				// 何もしない
			}
		// 時限チェックエラー
		}else if(res.result == 'TIMED_CHECK'){
			// ホーム画面（履歴なし）を表示
			changeDisp('noInq');
			// モーダルを表示
			return;
		// システムエラー 
		}else{
			
			changeDisp('noInq');

			return;
		}

		// お問い合わせ詳細
		document.getElementById('inqTextInput').value = null;
		if($("#inqTextInput").val() == ''){
			// 黄色
			$("#inqTextInput").css('background', '#ffffcc');
		}
		// お問い合わせ種類が入力されている
		let inqTypeElem = document.getElementById('Modal-inqType');
		if(!inqTypeElem.classList.contains('reqEntry')){
			inqTypeElem.classList.remove('inputSelectItem-on');
			inqTypeElem.classList.remove('data-on');
			inqTypeElem.classList.add('reqEntry');
			inqTypeElem.innerHTML = '選択してください';
			let choiceList = document.getElementsByName('inqType');
			for(i = 0; i < choiceList.length; i++){
				choiceList[i].checked="";
			}
		}
		// 新規のファイル出力先に子要素があればTRUE
        const inqFileElemcheck = document.getElementById('inqFileList').hasChildNodes();
        // 子要素があるかどうかチェック
        if(inqFileElemcheck){
			let inqFileElem = document.getElementById('inqFileList');
            // 子要素が無くなるまで削除
            while(inqFileElem.firstChild){
				inqFileElem.removeChild(inqFileElem.firstChild);
            }
        }
		// 個別の投稿内容
		document.getElementById('cbdTextInput').value = null;
		if($("#cbdTextInput").val() == ''){
			// 黄色
			$("#cbdTextInput").css('background', '#ffffcc');
		}
		// 個別のファイル出力先に子要素があればTRUE
        const cbdFileElemcheck = document.getElementById('cbdFileList').hasChildNodes();
        // 子要素があるかどうかチェック
        if(cbdFileElemcheck){
            let cbdFileElem = document.getElementById('cbdFileList');
            // 子要素が無くなるまで削除
            while(cbdFileElem.firstChild){
                cbdFileElem.removeChild(cbdFileElem.firstChild);
            }
        }
		// 出力先要素に子要素があればTRUE
        const elemcheck = document.getElementById('listQa').hasChildNodes();
        // 子要素があるかどうかチェック
        if(elemcheck){
            let parent = document.getElementById('listQa');
            // 子要素が無くなるまで削除
            while(parent.firstChild){
                parent.removeChild(parent.firstChild);
            }
        }
		// 入力画面出力用
		eMail = res.accMail;
		// 新規入力画面に反映
		document.getElementById('newInqMail').innerHTML = eMail;
		// コンテンツバーション取得のためのPromise生成
		const fileGetPromise = new Promise((resolve) => {
			// ファイルIDのリスト
			const fileIdList = new Array();
			// ケースのリストサイズが0でない
			if(res.caseList.length != 0){
				// ケースをループ
				for(i = 0; i < res.caseList.length; i++){
					// コンタクトボード明細を取得
					const cbdFileList = res.caseList[i].cbdFileList;
					// コンタクトボード明細をループ
					for(j = 0; j < cbdFileList.length; j++){
						// 添付ファイルをループ
						for(k = 0; k < cbdFileList[j].contentVersions.length; k++){
							// 要素をインスタンス化
							const cv = cbdFileList[j].contentVersions[k];
							// 取得できている場合
							if(cv){
								// IDをリストに退避
								fileIdList.push(cv.Id);
							}
						}
					}
				}
			}
			// 添付ファイルがある場合
			if(fileIdList.length > 0){
				// 添付ファイルを取得
				getContentVersion(fileIdList, resolve, 0);
			// 添付ファイルなし
			}else{
				// 次の処理を呼び出す
				resolve();
			}
		// promise処理がすべて完了してから実行　※添付ファイルがある場合、resolveのコールはgetContentVersion内で行う
		}).then(() => {
			// Cookie取得処理を呼び出す
			const cookieList = getCookie();
			// ケースをループ
			for(let c = 0; c < res.caseList.length; c++){
				// NEW表示フラグをfalseで初期化
				let newDisplayFlag = false;
				// コンタクトボード明細を取得
				const cbdFileList = res.caseList[c].cbdFileList;
				// コンタクトボード明細をループ
				for(let i = 0; i < cbdFileList.length; i++){
					// 1ヶ月前の日付用変数に現在日を取得して-1ヶ月する
					let nowDateTime = new Date();
					// 現在年を取得
					const year = nowDateTime.getFullYear();
					// 月を取得して、1ヶ月増やして
					const month = nowDateTime.getMonth() + 1;
					// 日を取得する
					const date = nowDateTime.getDate();
					// 先頭文字列'0'に、1）から時間(h)を取得して結合した値を最後から2文字までを変数に格納
					const hour = (`0` + (nowDateTime.getHours())).slice(-2);
					// 先頭文字列'0'に、1）から分(m)を取得して結合した値を最後から2文字までを変数に格納
					const minute = (`0` + (nowDateTime.getMinutes())).slice(-2);
					// Dateに変換
					nowDateTIme = new Date(`${year}/${month-1}/${date} ${hour}:${minute}`);
					// コンタクトボード明細の時間
					let cbdDateTime = new Date(cbdFileList[i].cbd.CreatedDate);
					// 以下のいずれかの条件でnew表示を付与
					// ・コンタクトボード明細の最終更新日が現在日時 - 1ヶ月以後（同値を含む）
					// ・（お客様からの）問い合わせ以外
					// ・（Cookieにて）未参照
					if(
						cbdDateTime >= nowDateTIme &&
						cbdFileList[i].cbd.Classification__c != "問い合わせ" &&
						cookieList.indexOf(cbdFileList[i].cbd.Id) < 0
					){
						// NEW表示フラグをfalseに設定
						newDisplayFlag = true;
						// 以後処理不要
						break;
					}
				}
				// NEW表示フラグを反映
				res.caseList[c]["isNew"] = newDisplayFlag;
			}
			/*** タグを生成 ***/
			// Case template要素を取得
			let caseTemplate = document.getElementById('caseTemplate');
			// newIcon template要素を取得
			let iconTemplate = document.getElementById('newIconTemplate');
			// ケースのリストの件数分
			for(let i = 0; i < res.caseList.length; i++){
				// 要素を取得
				const c = res.caseList[i];
				// case template要素の内容を複製
				let clone = caseTemplate.content.cloneNode(true);
				// お問い合わせ内容を取得
				let content = c.content;
				// お問い合わせ詳細がnullでない
				if(content != null){
					// 12文字を超える場合
					if(content.length > 30){
						// 省略する
						content = content.substring(0, 30) + "...";
					}
				}
				// 複製したtemplate要素にデータを挿入
				// ケースのIdを設定
				clone.querySelector('.inq-id').dataset.cId = c.record.Id;
				// ケース番号を設定する
				clone.querySelector('.inq-title').textContent = 'No.' + c.record.CaseNumber;
				// お問い合わせ内容を設定する
				clone.querySelector('.cbd-content').textContent = content;
				// ケースの作成日をJST日付かつスラッシュに変換して、設定
				clone.querySelector('.inq-createdate').textContent = changeSlashDate(c.record.CreatedDate);
				// お問い合わせ種類を設定する
				clone.querySelector('.inq-type').textContent = c.record.SubjectIMF__c;
				// ケースのステータスを設定する
				clone.querySelector('.inq-status').textContent = c.record.StatusClient__c;
				// 「回答完了」、「回答に少しお時間をいただいております。」の場合
				if(c.record.StatusClient__c == '回答完了' || c.record.StatusClient__c == '回答に少しお時間をいただいております。'){
					// CSSクラスを削除（グレー）
					clone.querySelector('.inq-status').classList.remove('txt-not-fin');
					// CSSクラスを追加（グリーン）
					clone.querySelector('.inq-status').classList.add('txt-fin');
				}
				// NEW表示しない場合
				if(!c.isNew){
					// newを非表示にする
					clone.querySelector(".list-qa-ic").style.display = "none";
				}
				// caseを画面に出力
				document.getElementById('listQa').appendChild(clone);
			}
		});
	}
	
	/***
	 * 画面の表示非表示切り替え
	 * 引数：遷移先画面(div)Id
	 ***/
	function changeDisp(nextScreen){
		// 画面IDリストループ
		for(i = 0; i < screenNameList.length; i++){
			// 指定IDの場合
			if(screenNameList[i] == nextScreen){
				// 表示
				document.getElementById(screenNameList[i]).style.display = 'block';
			// それ以外
			}else{
				// 非表示
				document.getElementById(screenNameList[i]).style.display = 'none';
			}
		}
	}
	
	/**
	 * 初期表示時データ取得
	 */
	function getAllCase(){
		$.ajax({
			type:'POST',
			crossOrigin:true,
			url: REQUEST_DOMAIN + '/services/oauth2/token',
			dataType:'json',
			cache:false,
			data:{
				"grant_type":"refresh_token",
				"client_id":CLIENT_ID, 
				"refresh_token":REFLESH_TOKEN
			}
		}).done(function(connectData){
			var accToken = 'Bearer ' + connectData.access_token;
			$.ajax({
				type:'GET',
				crossOrigin:true,
				url:REQUEST_DOMAIN + '/services/apexrest/IMF_Case',
				dataType:'json',
				cache:false,
				data:{inquiry:linkedStr},
				headers: {"Authorization":accToken}
			}).done(function(response){
				if(response.errorMessage){
					errorMessageText = response.errorMessage.replace(/\n/g, '<br>');
				}
				
				// 成功
				if(response.result == 'SUCCESS'){
					res = response;
					init();
					// 時限チェック
				}else if(response.result == 'TIMED_CHECK'){
					dispTimeoutErrModal();
				// 取引先0件
				}else if(response.result == 'NO_ACCOUNT'){
				// 異常終了
				}else{
					dispAbnormalErrModal();
				}
			}).fail(function (data, errorThrown, status){
				dispComErrModal();
			});
		}).fail(function (data, errorThrown, status) {
			dispComErrModal();
		});
	}
	
    /**
	 * 初期表示時データ取得
	 */
	function registInquery(){
		// アクセストークン取得（リフレッシュトークンフロー） Ajax
		$.ajax({
			type: 'POST',
			crossOrigin: true,
			url: REQUEST_DOMAIN + '/services/oauth2/token',
			dataType: 'json',
			cache :false,
			data : {
				"grant_type":"refresh_token",
				"client_id":CLIENT_ID, 
				"refresh_token":REFLESH_TOKEN
			}
		}).done(function (connectData) {
			var accToken = 'Bearer ' + connectData.access_token;
			$.ajax({
				type:'POST',
				crossOrigin:true,
				url:REQUEST_DOMAIN + '/services/apexrest/IMF_Case',
				cache:false,
				headers:{"Authorization":accToken, "Content-Type":"application/json"},
				dataType:'json',
				data:JSON.stringify(inqRegistData)
			}).done(function(response){
				const cbdId = response.cbdId;
				if(response.errorMessage){
					errorMessageText = response.errorMessage.replace(/\n/g, '<br>');
				}
				if(response.result == 'SUCCESS'){
					if(cbdId){
						changeDisp('compScreen');
					}
				// メールアドレス不正
				}else if(response.result == 'INVALID_EMAIL_ADDRESS'){
					dispInvmailErrModal();
				// 時限チェック
				}else if(response.result == 'TIMED_CHECK'){
					dispTimeoutErrModal();
				// 異常終了
				}else{
					dispAbnormalErrModal();
				}
				if(inputFiles.length > 0){
					for(let i = 0; i < inputFiles.length; i++){
						const cvJson = {
							Title:inputFiles[i].name,
							PathOnClient:inputFiles[i].name,
							VersionData:inputFiles[i].versionData
						}
						$.ajax({
							type:"POST",
							url:REQUEST_DOMAIN + "/services/data/v54.0/sobjects/ContentVersion",
							cache:false,
							headers:{"Authorization":accToken, "Content-Type":"application/json"},
							dataType:"json",
							data:JSON.stringify(cvJson)
						}).done(function(cv){
							const cvId = cv.id;
							const query = "SELECT+ContentDocumentId+FROM+ContentVersion+WHERE+Id+=+'" + cvId + "'";
							$.ajax({
								type:"GET",
								crossOrigin:true,
								url:REQUEST_DOMAIN + "/services/data/v54.0/query/?q=" + query,
								cache:false,
								headers: {"Authorization":accToken}
							}).done(function(res){
								const records = res.records;
								const cdId = records[0].ContentDocumentId;
								const linkJson = {
									ContentDocumentId:cdId,
									LinkedEntityId:cbdId,
									Visibility:"AllUsers"
								};
								$.ajax({
									type:"POST",
									crossOrigin:true,
									url:REQUEST_DOMAIN + "/services/data/v54.0/sobjects/ContentDocumentLink",
									cache:false,
									headers:{"Authorization":accToken, "Content-Type":"application/json"},
									dataType:"json",
									data:JSON.stringify(linkJson)
								}).done(function(res){

								}).fail(function(data, errorThrown, status) {
									dispRegisComErrModal();
								});
							}).fail(function(data, errorThrown, status) {
								dispRegisComErrModal();
							});
						}).fail(function(data, errorThrown, status) {
							dispRegisComErrModal();
						});
					}
				}
			}).fail(function (data, errorThrown, status) {
				dispRegisComErrModal();
			});
		}).fail(function (data, errorThrown, status) {
			dispRegisComErrModal();
		});
	}
	
	/**
	 * 初期表示時データ取得
	 */
	function registContactBoard(){
		// アクセストークン取得（リフレッシュトークンフロー） Ajax
		$.ajax({
			type: 'POST',
			crossOrigin: true,
			url: REQUEST_DOMAIN + '/services/oauth2/token',
			dataType: 'json',
			cache :false,
			data : {
				"grant_type":"refresh_token",
				"client_id":CLIENT_ID, 
				"refresh_token":REFLESH_TOKEN
			}
		}).done(function (connectData) {
			var accToken = 'Bearer ' + connectData.access_token;
			$.ajax({
				type:'POST',
				crossOrigin:true,
				url:REQUEST_DOMAIN + '/services/apexrest/IMF_ContactBoardDetail',
				cache:false,
				headers: {"Authorization":accToken, "Content-Type":"application/json"},
				dataType:'json',
				data:JSON.stringify(cbdRegistData)
			}).done(function(response){
				const cbdId = response.cbdId;
				if(response.errorMessage){
					errorMessageText = response.errorMessage.replace(/\n/g, '<br>');
				}
				if(response.result == 'SUCCESS'){
					if(cbdId){
						changeDisp('compScreen');
					}
				// 時限チェック
				}else if(response.result == 'TIMED_CHECK'){
					dispTimeoutErrModal();
				// 異常終了
				}else{
					dispAbnormalErrModal();
				}
				if(inputFiles.length){
					for(let i = 0; i < inputFiles.length; i++){
						const cvJson = {
							Title:inputFiles[i].name,
							PathOnClient:inputFiles[i].name,
							VersionData:inputFiles[i].versionData
						}
						$.ajax({
							type:"POST",
							url:REQUEST_DOMAIN + "/services/data/v54.0/sobjects/ContentVersion",
							cache:false,
							headers:{"Authorization":accToken, "Content-Type":"application/json"},
							dataType:"json",
							data:JSON.stringify(cvJson)
						}).done(function(cv){
							const cvId = cv.id;
							const query = "SELECT+ContentDocumentId+FROM+ContentVersion+WHERE+Id+=+'" + cvId + "'";
							$.ajax({
								type:"GET",
								crossOrigin:true,
								url:REQUEST_DOMAIN + "/services/data/v54.0/query/?q=" + query,
								cache:false,
								headers: {"Authorization":accToken}
							}).done(function(res){
								const records = res.records;
								const cdId = records[0].ContentDocumentId;
								const linkJson = {
									ContentDocumentId:cdId,
									LinkedEntityId:cbdId,
									Visibility:"AllUsers"
								};
								$.ajax({
									type:"POST",
									crossOrigin:true,
									url:REQUEST_DOMAIN + "/services/data/v54.0/sobjects/ContentDocumentLink",
									cache:false,
									headers:{"Authorization":accToken, "Content-Type":"application/json"},
									dataType:"json",
									data:JSON.stringify(linkJson)
								}).done(function(res){
								}).fail(function(data, errorThrown,status) {
									dispRegisComErrModal();
								});
							}).fail(function(data, errorThrown, status) {
								dispRegisComErrModal();
							});
						}).fail(function(data, errorThrown, status) {
							dispRegisComErrModal();
						});
					}
				}
			}).fail(function (data, errorThrown, status) {
				dispRegisComErrModal();
			});
		}).fail(function (data, errorThrown, status) {
			dispRegisComErrModal();
		});
	}
	
	/***
	 * コンテンツバージョン（ファイル）取得処理
	 * 引数　：コンテンツバージョンId
	 * 返却値：ファイルの中身
	 ***/
	function getContentVersion(fileIdList, resolve, index){
		
		const fileId = fileIdList[index];
	
		$.ajax({
			type:'POST',
			crossOrigin: true,
			url:REQUEST_DOMAIN + '/services/oauth2/token',
			dataType:'json',
			cache:false,
			data:{
				"grant_type":"refresh_token",
				"client_id":CLIENT_ID, 
				"refresh_token":REFLESH_TOKEN
			}
		}).done(function (connectData) {
			var accToken = 'Bearer ' + connectData.access_token;
			$.ajax({
				type:'GET',
				crossOrigin:true,
				url:REQUEST_DOMAIN + '/services/data/v54.0/sobjects/ContentVersion/' + fileId + '/VersionData',
				cache:false,
				headers:{"Authorization":accToken},
				xhrFields:{responseType:'blob'}
			}).done(function(fileContent){
				// ケースのリストサイズが0でない
				if(res.caseList.length != 0){
					// ファイルの紐付け有無
					let fileAttached = false;
					// ケースをループ
					for(let i = 0; i < res.caseList.length; i++){
						// コンタクトボード明細を取得
						const cbdFileList = res.caseList[i].cbdFileList;
						// コンタクトボード明細をループ
						for(let j = 0; j < cbdFileList.length; j++){
							// 添付ファイルをループ
							for(let k = 0; k < cbdFileList[j].contentVersions.length; k++){
								// 要素をインスタンス化
								const cv = cbdFileList[j].contentVersions[k];
								
								if(cv.Id == fileId){
									// IDを条件に添付ファイルのBlobデータを取得
									res.caseList[i].cbdFileList[j].contentVersions[k]["versionData"] = fileContent;
									// 紐付け済にする
									fileAttached = true;
									// 以後処理不要
									break;
								}
							}
							// 紐付け済の場合
							if(fileAttached){
								// 以後処理不要
								break;
							}
						}
						// 紐付け済の場合
						if(fileAttached){
							// 以後処理不要
							break;
						}
					}
				}
				// 全て紐付け終わったら
				if(fileIdList.length - 1 == index){
					// 次の処理を呼ぶ
					resolve();
				// まだ終わってない場合
				}else{
					// 再帰実行する
					getContentVersion(fileIdList, resolve, index + 1);
				}
			}).fail(function (data, errorThrown, status) {
				dispRegisComErrModal();
			});
		}).fail(function (data, errorThrown, status) {
			dispRegisComErrModal();
		});
	}
	
	/**
	 * 初期表示処理（コンタクトボード明細）
	 */
	function sendDetailsScreen(selectedCaseId){
		// 画面内容をクリアする
		document.getElementById('outputCbdTemp').innerHTML = null;
		// 投稿するボタンにケースIdを設定
		document.getElementById('replyButton').dataset.cId = selectedCaseId;
		// Cookie取得処理を呼び出す
		const CookieList = getCookie();
		// NEW付与対象のIDを格納する配列
		let newTargetList = [];
		
		let cbdFileList;
		// ケースの件数分
		for(i = 0; i < res.caseList.length; i++){
		
			const rec = res.caseList[i].record;
			// URLのケースIdとセッションストレージから取得したケースIdが一致する場合
			if(selectedCaseId == rec.Id){
				// ページタイトルを設定
				document.getElementById('contbrdTitle').textContent = 'お問い合わせ番号：No.' + rec.CaseNumber;
				
				cbdFileList = res.caseList[i].cbdFileList;
				// コンタクトボード明細レコードとファイルの組み合わせリストの件数分
				for(j = 0; j < cbdFileList.length; j++){
				
					let idFlg = {};
					// NEW表示フラグをfalseで初期化
					let newDisplayFlag = false;
					// 1ヶ月前の日付用変数に現在日を取得して-1ヶ月する
					let nowDateTime = new Date();
					const year = nowDateTime.getFullYear();
					// 月を取得して、1ヶ月増やして
					const month = nowDateTime.getMonth() + 1;
					// 日を取得する
					const date = nowDateTime.getDate();
					// 先頭文字列'0'に、1）から時間(h)を取得して結合した値を最後から2文字までを変数に格納
					const hour = (`0` + (nowDateTime.getHours())).slice(-2);
					// 先頭文字列'0'に、1）から分(m)を取得して結合した値を最後から2文字までを変数に格納
					const minute = (`0` + (nowDateTime.getMinutes())).slice(-2);
					nowDateTime = new Date(`${year}/${month-1}/${date} ${hour}:${minute}`);
					// コンタクトボード明細の時間
					let cbdDateTime = new Date(cbdFileList[j].CreatedDate);
					// 以下のいずれかの条件でnew表示を付与
					// ・コンタクトボード明細の最終更新日が現在日時 - 1ヶ月以後（同値を含む）
					// ・（お客様からの）問い合わせ以外
					// ・（Cookieにて）未参照
					if(
						cbdDateTime >= nowDateTIme &&
						cbdFileList[i].cbd.Classification__c != "問い合わせ" &&
						cookieList.indexOf(cbdFileList[i].cbd.Id) < 0
					){
						newTargetList.push(cbdFileList[i].cbd.Id);
						newDisplayFlag = true;
					}
					
					cbdFileList[j].isNew = newDisplayFlag;
				}
			}
		}
		// コンタクトボード明細templateを取得
		let caseTemplate = document.getElementById('cbdTemplate');
		// newIcon template要素を取得
		let iconTemplate = document.getElementById('newIconTemplate');
		// コンタクトボード明細のリストの件数分
		for(let i = 0; i < cbdFileList.length; i++){
			// 要素を取得
			const cbd = cbdFileList[i].cbd;
			// 紐付く添付ファイルを取得
			const cvList = cbdFileList[i].contentVersions;
			// コンタクトボード明細templateの内容を複製
			let clone = cbdTemplate.content.cloneNode(true);
			// 複製したtemplate要素にデータを挿入	
			// レコード種別が、お客さまの場合
			if(cbd.Classification__c == '問い合わせ'){
				// お客さまクラスを付与
				clone.querySelector('.contbrd-head').classList.add('customer');
				// アクター名を「お客さま」に設定
				clone.querySelector('.actor-text').textContent = 'お客さま';
				// コンタクトボード明細の投稿内容をそのまま設定
				clone.querySelector('.contbrd-content').textContent = cbd.Content__c;
			// PayPay銀行の場合
			}else{
				// 回答クラスを付与
				clone.querySelector('.contbrd-head').classList.add('answer');
				// アクター名を「PayPay銀行」に設定
				clone.querySelector('.actor-text').textContent = 'PayPay銀行';
				// コンタクトボード明細の投稿内容を引数にURLリンク化処理を呼び出し
				let content = AutoLink(cbd.Content__c);
				// 値がNullではない場合
				if(content != null){
					// リンク化した投稿内容を設定
					// textContentに入れるとHTMLエンティティに変換されるため、innerHTMLに入れる
					clone.querySelector('.contbrd-content').innerHTML = content;
				// 値がNullの場合
				}else{
					// コンタクトボード明細の投稿内容をそのまま設定
					clone.querySelector('.contbrd-content').innerHTML = cbd.Content__c;
				}
			}
			// コンタクトボード明細の作成日を日付をJSTに変換する処理を呼び出して、設定する
			clone.querySelector('.createddate').textContent = changeSlashDate(cbd.CreatedDate);
			clone.querySelector('.contbrd-txt').id = 'file' + cbd.Id;
			// 繰り返し初回の場合
			if(i == 0){
				// 初回の全表示用クラスを付与
				clone.querySelector('.contbrd-body').classList.add('first');
			}
			// NEW表示しない場合
			if(!cbdFileList[i].isNew){
				// New表示を隠す
				clone.querySelector(".new-icon").style.display = "none";
			}
			// コンタクトボード明細を画面に出力
			document.getElementById('outputCbdTemp').appendChild(clone);
			// ファイルがある場合
			if(cbdFileList[i].contentVersions.length > 0){
				// file template要素を取得
				let fileTemplate = document.getElementById('fileTemplate');
				// 「ファイル」固定文言タグを生成
				let fileFixedText = document.createElement('p');
				
				fileFixedText.innerHTML = 'ファイル';
				
				fileFixedText.style = 'font-weight: bold;margin-top: 10px'
				// 画面に追加
				document.getElementById('file' + cbd.Id).appendChild(fileFixedText);
				// 添付ファイルリストを取得
				const cvList = cbdFileList[i].contentVersions;
				// ファイルの件数分
				for(j = 0; j < cvList.length; j++){
					// file template要素の内容を複製
					let fileClone = fileTemplate.content.cloneNode(true);
					// ファイルの中身からダウンロード用リンクを生成
					let fileUrl = URL.createObjectURL(new Blob(
						[cvList[j].versionData],
						{type: "application/octet-stream"}
					));
					// 画面出力するファイル名を設定する
					fileClone.querySelector('.fileLink').textContent = cvList[j].Name;
					// ダウンロードされる際のファイル名を設定する
					fileClone.querySelector('.fileLink').download = cvList[j].Name;
					// ダウンロード用リンクを設定する
					fileClone.querySelector('.fileLink').href = fileUrl;
					// ファイルを画面に出力
					document.getElementById('file' + cbd.Id).appendChild(fileClone);
				}
			}
		}
		// NEW表示対象がある場合
		if(newTargetList.length > 0){
			// 表示したため、Cookieの情報を書き換える
			setCookie(newTargetList);
		}
	}
	
	/***
	 * URLリンク化処理
	 * 引数　：文字列
	 * 返却知：URL部分をリンク化した文字列
	 ***/
	function AutoLink(str) {
		if(!str){return;}
		// 正規表現
		let regexp_url = /((h?)(ttps?:\/\/[a-zA-Z0-9.\-_@:/~?%&;=+#',()*!]+))/g; // ']))/;
		let regexp_makeLink = function(all, url, h, href) {
		return '<a href="h' + href + '" target="_blank">' + url + '</a>';
		}
		return str.replace(regexp_url, regexp_makeLink);
	}

	/***
	 * Cookie取得処理
	 * 引数　：なし
	 * 返却値：cbdIdリスト
	 ***/
	 function getCookie(){
		// 結果返却用配列
		let resultCbdIdList = [];
		// Cookieを取得
		let nowCookie = document.cookie;
		// Cookieがnullもしくはundefinedでない場合
		if(nowCookie){
			// 値を ';' で分割して1）の配列に格納
			const tempIdList = nowCookie.split(";");
			
			for(let i = 0; i < tempIdList.length; i++){
				// 値を '=' で分割
				const data = tempIdList[i].split("=");
				// キーが本処理で扱うCookieの場合
				if((data[0] == "IMFCookie") && data[1]){
					// 結果返却用配列に追加
					return JSON.parse(data[1]);
				}
			}
		}
		// 結果を返却
		return resultCbdIdList;
	}
	
	/**
	 * Cookieに値設定
	 */
	function setCookie(cbdIdList){
		// Cookieを分割して格納する配列
		let tempIdList = [];
		// 結果返却用配列
		let resultCbdIdList = [];
		// Cookieを取得
		let nowCookie = document.cookie;
		// Cookieがnullもしくはundefinedでない場合
		if(nowCookie){
			// 値を ';' で分割して1）の配列に格納
			tempIdList = nowCookie.split(';');
			// 値の件数分
			tempIdList.forEach(data => {
				// 値を '=' で分割
				data = data.split('=');
				// キーが本処理で扱うCookieの場合
				if(data[0] == 'IMFCookie'){
					// 結果返却用配列に追加
					resultCbdIdList = JSON.parse(data[1]);
				}
			})
		}
		
		for(let i = 0; i < cbdIdList.length; i++){
			if(resultCbdIdList.indexOf(cbdIdList[i]) < 0){
				resultCbdIdList.push(cbdIdList[i]);
			}
		}
		
		document.cookie = 'IMFCookie=' + JSON.stringify(resultCbdIdList) + "; max-age=30";
	}
	
	/***
	 * 個別問い合わせ 詳細画面の遷移処理
	 * 引数　：ケースId
	 * 返却値：なし
	 ***/
	 function inquiryDetailScreenTransition(caseId){
		sendDetailsScreen(caseId);
		changeDisp("detailsScreen");
	}
	/*** 
	 * 日付をJSTに変換する処理
	 * 引数　：2022-06-06T04:43:08.000+0000
	 * 返却値：2022/06/06 04:43
	 ***/
	function changeSlashDate(dateTime){
		// 日付オブジェクトに引数の日付を設定して準備
		const newDate = new Date(dateTime);
		// 年を取得
		const year = newDate.getFullYear();
		// 月を取得し1を加算
		const month = (`0` + (newDate.getMonth() + 1)).slice(-2);
		// 日を取得
		const day = (`0` + (newDate.getDate())).slice(-2);
		// 先頭文字列'0'に、1）から時間(h)を取得して結合した値を最後から2文字までを変数に格納
		const hour = (`0` + (newDate.getHours())).slice(-2);
		// 先頭文字列'0'に、1）から分(m)を取得して結合した値を最後から2文字までを変数に格納
		const minute = (`0` + (newDate.getMinutes())).slice(-2);
		// 値を返却
		return `${year}/${month}/${day} ${hour}:${minute}`;
	}
	
	/**
	 * 入力画面で入力された情報を確認画面の要素に反映
	 */
	function outputValueInqConf(){
		inqRegistData.EncryptedData = linkedStr;
		inqRegistData.Subject = document.getElementById('Modal-inqType').innerHTML;
		inqRegistData.Content = document.getElementById('inqTextInput').value;
		
        // 2000文字以下チェック
        if(checkVal(inqRegistData.Content)){
            // エラーメッセージがない場合実行
            if(document.getElementById("inqTextareaErrorMessege") == null){
                // エラー表示領域を取得　
                let outputArea = document.getElementById('inqOutputError');
                // エラー要素を作成
                let errorMessege = document.createElement('span');
                errorMessege.id = 'inqTextareaErrorMessege';
                errorMessege.innerHTML = '2000文字以内で入力してください。';
                errorMessege.style.color = '#FF0033';
                outputArea.appendChild(errorMessege);
                // 処理を中断する
                return null;
            }else{
                // エラーメッセージがある場合、エラーメッセージを削除する
                if(document.getElementById("inqTextareaErrorMessege") != null){
                    const element = document.getElementById('inqTextareaErrorMessege'); 
                    element.remove();
                }
            }
        }
		document.getElementById('inqConfMailText').innerHTML = eMail;
		document.getElementById('inqConfTypeText').innerHTML = inqRegistData.Subject;
		document.getElementById('inqConfDtailsText').innerHTML = inqRegistData.Content;
		// 選択値を取得
		const jinkakuCode = $('input[name="JinkakuCode"]').val();
		let selectedItem = document.getElementById('Modal-inqType').innerHTML;
		// 画面入力されたお問い合わせ種類
		if(jinkakuCode == '個人' || jinkakuCode == '非居住者'){
			// 各種手続きダイヤル設定対象の場合
			if(procedureDialList.includes(selectedItem)){
				inqRegistData.LinkedDial = '各種手続きダイヤル';
			}else{
				inqRegistData.LinkedDial = 'その他ダイヤル';
			}
			// 人格コードが法人の場合
		}else{
			inqRegistData.LinkedDial = '法人ダイヤル';
		}
		
		document.getElementById("inqUploadFiles").innerHTML = null;
		
		for(let i = 0; i < inputFiles.length; i++){
			const p = document.createElement("p");
			p.innerText = inputFiles[i].name;
			document.getElementById("inqUploadFiles").appendChild(p);
		}
		
		// 確認画面へ遷移する
        changeDisp('inqConfirmScreen');
	}
	
	/**
	 * 入力画面で入力された情報を確認画面の要素に反映
	 */
	function outputValueCbdConf(){
		cbdRegistData.EncryptedData = linkedStr;
		cbdRegistData.CaseId = document.getElementById('replyButton').dataset.cId;
		cbdRegistData.Content = document.getElementById('cbdTextInput').value;
		document.getElementById('cbdConfDtailsText').innerHTML = cbdRegistData.Content;
		// 2000文字チェック
        if(checkVal(cbdRegistData.Content)){
            // エラーメッセージがない場合実行
            if(document.getElementById("cbdTextareaErrorMessege") == null){
                // エラー表示領域を取得　
                let outputArea = document.getElementById('cbdOutputError');
                // エラー要素を作成
                let errorMessege = document.createElement('span');
                errorMessege.id = 'cbdTextareaErrorMessege';
                errorMessege.innerHTML = '2000文字以内で入力してください。';
                errorMessege.style.color = '#FF0033';
                outputArea.appendChild(errorMessege);
                // 処理を中断する
                return null;
            }else{
                // エラーメッセージがある場合、エラーメッセージを削除する
                if(document.getElementById("cbdTextareaErrorMessege") != null){
                    const element = document.getElementById('cbdTextareaErrorMessege'); 
                    element.remove();
                }
            }
        }
        
        document.getElementById("cbdUploadFiles").innerHTML = null;
		
		for(let i = 0; i < inputFiles.length; i++){
			const p = document.createElement("p");
			p.innerText = inputFiles[i].name;
			document.getElementById("cbdUploadFiles").appendChild(p);
		}
        
        changeDisp('replyConfirmScreen');
	}
	
	// 2000文字チェック
	function checkVal(content){
        // 値がない場合、エラー
        if(!content){return true}
        return (content.length <= 2000) ? false : true
    }

	/**
	 * 入力されたらボタンを活性化する
	 */
	function inqReqCheck(){
		
		const itype_flg = ( $('#Modal-inqType').html() == "選択してください" ) ? false : true;
		const idtail_flg = ($('#inqTextInput').val() === "") ? false : true;
		
		let isBtnActive;
		
		if(itype_flg && idtail_flg){
			isBtnActive = true;
		}else{
			isBtnActive = false;
		}
		
		$('#confButton').prop("disabled", !isBtnActive);
	}
	
	/**
	 * 入力されたらボタンを活性化する
	 */	
	function cbdReqCheck () {
	
		const cdtail_flg = ( $('#cbdTextInput').val() === "" ) ? false : true;
		
		let isBtnActive;
		
		if(cdtail_flg){
			isBtnActive = true;
		}else{
			isBtnActive = false;
		}
		
		$('#cbdConfButton').prop("disabled", !isBtnActive);
	}
	/**
	 * 戻るボタン処理（新規投稿）
	 */
	function inqPrevAction(){
		// 問い合わせ種類選択の値設定状況確認
		itype_flg = (typeof $('input[name="inqType"]:checked').val() === "undefined") ? false : true;
		// 問い合わせ内容の入力状況確認
		idtail_flg  = ($('#inqTextInput').val() === "" ) ? false : true;
		// いずれか入力されている場合
		if(itype_flg || idtail_flg || inputFiles.length > 0){
			// 確認ダイアログを表示
			$(".modalOverlay,.error-type1").fadeIn();
			$("body").css({position:"fixed",top:-1});
		// いずれも未入力の場合
		}else{
			// ホーム画面に遷移
			changeDisp('inquiryForm');
		}
	}
	/**
	 * 戻るボタン時の入力内容クリア処理（新規投稿）
	 */
	function inqClearInput(){
		// 問い合わせ種類選択をクリア
		$('input[name="inqType"]:checked').prop("checked", false);
		$("#Modal-inqType").html("選択してください");
		// 表示色の調整
		if(!$("#Modal-inqType").hasClass("reqEntry")){
			$("#Modal-inqType").addClass("reqEntry").removeClass("inputSelectItem-on data-on");
		}
		// 問い合わせ内容をクリア
		$('#inqTextInput').val(null);
		// ファイルアップロード用ファイルをリセット
		inputFiles = new Array();
		// アップロード済ファイルサイズをリセット
		uploadedFileSize = 0;
		// オーバレイをクリア（残すと前画面でオーバレイが残るため）
		$('.modalOverlay,.error-type1').fadeOut();
		
/*** ADD K.Y ***/
		if(res.result == 'SUCCESS'){
			if(!res.caseList){ // お問い合わせ0件(null)の場合
				// ホーム画面（履歴なし）を遷移
				changeDisp('noInq');
				return;
			}else{ // お問い合わせあり
				// ホーム画面（履歴あり）に遷移
				changeDisp('inquiryForm');
				return;
			}
		}
		// 新規のファイル出力先に子要素があればTRUE
        const inqFileElemcheck = document.getElementById('inqFileList').hasChildNodes();
        // 子要素があるかどうかチェック
        if(inqFileElemcheck){
			let inqFileElem = document.getElementById('inqFileList');
            // 子要素が無くなるまで削除
            while(inqFileElem.firstChild){
				inqFileElem.removeChild(inqFileElem.firstChild);
            }
        }
	}
	/**
	 * 戻るボタン処理（追加投稿）
	 */
	function cbdPrevAction(){
		// 問い合わせ内容が未入力
		if($("#cbdTextInput").val() === "" && inputFiles.length <= 0){
			// 詳細画面に遷移
			changeDisp('detailsScreen');
		// 入力されている
		}else{
			// 確認ダイアログを表示
			$(".modalOverlay,.error-type1").fadeIn();
			$("body").css({position:"fixed",top:-1});
		}
	}
	/**
	 * 戻るボタン時の入力内容クリア処理（追加投稿）
	 */
	function cbdClearInput(){
		// 入力内容のクリア
		$("#cbdTextInput").val(null);
		// ファイルアップロード用ファイルをリセット
		inputFiles = new Array();
		// アップロード済ファイルサイズをリセット
		uploadedFileSize = 0;
		// オーバレイをクリア（残すと前画面でオーバレイが残るため）
		$(".modalOverlay,.error-type1").fadeOut();
		// 詳細画面に遷移
		changeDisp('detailsScreen');
	}
	/**
	 * 新規投稿時のファイル削除
	 */
	function inqDeleteFile(){
		$("#inqFileList").children()[selectFileIndex].remove();
		inputFiles.splice(selectFileIndex, 1);
	}
	/**
	 * 追加投稿時のファイル削除
	 */
	function cbdDeleteFile(){
		$("#cbdFileList").children()[selectFileIndex].remove();
		inputFiles.splice(selectFileIndex, 1);
	}
	/**
	 * ファイルアップロード処理（再帰）
	 */
	function recursiveFileRead(elemFile, files, index){
		// FileReader生成
		const reader = new FileReader();
		// アップロード用のファイル情報
		const inputFileData = {
			name:files[index].name,
			versionData:null
		};
		// ファイル読込時
		reader.onload = function(){
			// 読込結果の取得
			const baseFile = this.result;
			// （フォーマット定義部分を除去するため）カンマ分割
			const spFile = baseFile.split(",");
			// カンマ以後の内容を取得し、アップロード用のファイル情報に書き込む
			inputFileData.versionData = spFile[1];
			// アップロード用の配列に退避
			inputFiles.push(inputFileData);
			// 処理対象がある場合
			if(files.length - 1 > index){
				// 再帰実行
				recursiveFileRead(elemFile, files, index + 1);
			// 処理対象が無い場合
			}else{
				// 入力されたファイル情報をリセット
				elemFile.value = null;
			}
		}
		// ファイル読込の開始
		reader.readAsDataURL(files[index]);
	}
	
	function SelectRadio(id){
		var childName = $("#"+id).children("li").attr("name");
		var selectValue = $("input[name='"+childName+"']:checked").next().html();
		$("#Modal-"+ id).html(selectValue);
		var defValue = $("#Modal-"+ id).html();
		var defValueMsg = "選択してください";
		if(defValue == defValueMsg){
			if(!$("#Modal-"+ id).hasClass("reqEntry")){
				$("#Modal-"+ id).addClass("reqEntry").removeClass("inputSelectItem-on data-on");
			}
		}else if(defValue == ""){
			$('#Modal-'+ id).add().html("選択してください");
		}else{
			$("#Modal-"+ id).removeClass("reqEntry").addClass("inputSelectItem-on data-on");
		}
		NextBtnActivity();
	}
	
	function NextBtnActivity(){
		if (!($("body").find(".reqEntry").length)) {
			$("p").find("#nextBtn").prop("disabled", false);
		}else{
			$("p").find("#nextBtn").prop("disabled", true);
		}
	}

    // 通信失敗 出力
    function dispComErrModal(){
        let CurrentScrollY = $(window).scrollTop();
        $(".modalOverlay,.modalWrap_error.error-comError").fadeIn();
        $(".error-comError").css("display", "block");
        $("body").css({position:"fixed",top:-1 * CurrentScrollY});
    }
    // 時限チェック 出力
    function dispTimeoutErrModal(){
        if(errorMessageText){
            $(".eMessage-error-timeoutError").html(errorMessageText);
        }
        let CurrentScrollY = $(window).scrollTop();
        $(".modalOverlay,.modalWrap_error.error-timeoutError").fadeIn();
        $(".error-timeoutError").css("display", "block");
        $("body").css({position:"fixed",top:-1 * CurrentScrollY});
    }
    // 通信失敗 出力(登録時)
    function dispRegisComErrModal(){
        let CurrentScrollY = $(window).scrollTop();
        $(".modalOverlay,.modalWrap_error.error-comErrorRegis").fadeIn();
        $(".error-comErrorRegis").css("display", "block");
        $("body").css({position:"fixed",top:-1 * CurrentScrollY});
    }
    // システムエラー 出力
    function dispAbnormalErrModal(){
        if(errorMessageText){
            $(".eMessage-error-abnormalError").html(errorMessageText);
        }
        let CurrentScrollY = $(window).scrollTop();
        $(".modalOverlay,.modalWrap_error.error-abnormalError").fadeIn();
        $(".error-abnormalError").css("display", "block");
        $("body").css({position:"fixed",top:-1 * CurrentScrollY});
    }
    // メールアドレス不正 出力
    function dispInvmailErrModal(){
        if(errorMessageText){
            $(".eMessage-error-invmailError").html(errorMessageText);
        }
        let CurrentScrollY = $(window).scrollTop();
        $(".modalOverlay,.modalWrap_error.error-invmailError").fadeIn();
        $(".error-invmailError").css("display", "block");
        $("body").css({position:"fixed",top:-1 * CurrentScrollY});
    }
    // 取引先が存在しない(新規問い合わせ登録画面) 出力
    function dispNoaccErrModal(){
        if(res.result == 'NO_ACCOUNT'){
            if(errorMessageText){
                $(".eMessage-error-noaccError").html(errorMessageText);
            }
            let CurrentScrollY = $(window).scrollTop();
            $(".modalOverlay,.modalWrap_error.error-noaccError").fadeIn();
            $(".error-noaccError").css("display", "block");
            $("body").css({position:"fixed",top:-1 * CurrentScrollY});
        }
    }
//-->
</script>

<!-- InquiryForm -->
<div id="inquiryForm" class="contents" style="display:none;">
	<div class="blk">
		<div class="blkCont bdrT0">
			<div class="note">
				<p>お問い合わせの回答目安は原則、翌営業日です。</p>
			</div>
			<p class="txtR mt-16">
				<a id="newInq" href="javascript:void(0)" onclick="changeDisp('inqInputScreen')" class="btn btn02">新規お問い合わせ</a>
			</p>
			<div class="list-qa">
				<dl id="listQa"></dl>
			</div>
			<p>
				<a href="javascript:commonSubmit('ln0001')" title="Welcome Pageに戻る" class="btn btn02 btnL">Welcome Page</a>
			</p>
		</div>
	</div>
</div>
						
<!-- InquiryFormNoInq -->
<div id="noInq" class="contents contbrd-pt-cont" style="display:none;">
	<div class="blk">
		<div class="blkCont bdrT0">
			<p class="contbrd-formBtn">
				<a href="javascript:void(0);" onclick="changeDisp('inqInputScreen'); dispNoaccErrModal();" class="btn btn02">新規お問い合わせ</a>
			</p>
			<p class="contbrd-formTitle">お問い合わせフォームの使い方</p>
			<div class="stepCont">
				<div class="stepBox">
					<dl>
						<dt>STEP1</dt>
						<dd>
							<div class="img">
								<img src="/commontpl/images/category/contact_img001.png" alt="" width="180" height="192">
							</div>
							<p class="stepTxt">
								［新規お問い合わせ］<br class="smtOnlyBr">より投稿
							</p>
							<p>
								※Visaデビット・ローン・FX・投資信託・外貨預金は対象外です
							</p>
						</dd>
					</dl>
					<dl>
						<dt>STEP2</dt>
						<dd>
							<div class="img">
								<img src="/commontpl/images/category/contact_img002.png" alt="" width="180" height="192">
							</div>
							<p class="stepTxt">
								回答が投稿されたら<br>メールでお知らせ
							</p>
							<p>
								原則、翌営業日に回答します
							</p>
						</dd>
					</dl>
					<dl>
						<dt>STEP3</dt>
						<dd>
							<div class="img">
								<img src="/commontpl/images/category/contact_img003.png" alt="" width="180" height="192">
							</div>
							<p class="stepTxt">
								ログインして回答を確認
							</p>
							<p>
								好きなタイミングで回答を確認できます
							</p>
						</dd>
					</dl>
				</div>
			</div>
			<p>
				<a href="javascript:commonSubmit('ln0001')" title="Welcome Page" class="btn btn02 btnL">Welcome Page</a>
			</p>
		</div>
	</div>
</div>

<!-- DetailsScreen -->
<div id="detailsScreen" style="display:none;">
	<div class="contents no-title-h1 contbrd-pt-cont">
		<div class="blk">
			<div class="blkCont bdrT0">
				<p id="contbrdTitle" class="contbrd-title"></p>
				<div id="outputCbdTemp" class="contbrd-wrap"></div>
			</div>
		</div>
		<div class="contents">
			<div class="blk">
				<div class="blkCont bdrT0 contbrd-btnArea-box">
					<p>
						<a id="replyButton" href="javascript:void(0)" onclick="changeDisp('replyInputScreen');" title="投稿する" class="btn btn01 btnL">投稿する</a>
					</p>
					<p class="mt-16">
						<a href="javascript:void(0)" onclick="changeDisp('inquiryForm')" title="戻る" class="btn btn03 btnL">戻る</a>
					</p>
				</div>
			</div>
		</div>
	</div>
</div>

<!-- NewInquiry_InputScreen -->
<div id="inqInputScreen" class="contents no-title-h1" style="display:none;">
	<div class="blk">
		<div class="blkCont layout-form layout-form-normal">
			<div id="modalText">
				<p class="input-title">お問い合わせ種類</p>
				<p class="inputSelectWrap pulldown">
					<a href="javascript:void(0);" id="Modal-inqType" class="ModalBtn reqEntry">選択してください</a>
				</p>
				<div class="modalWrap pulldown modalWrap-inqType">
					<div class="modalOuter">
						<div class="modal__headArea">お問い合わせ種類</div>
						<div class="modal__bodyArea">
							<ul id="inqType" class="wrap-label-list">
								<li id="dial01" name="inqType"><label class="label-radio" for="inqType01"><input type="radio" name="inqType" value="1" id="inqType01" class="x-data-inqType"><span>登録情報の変更</span></label></li>
								<li id="dial02" name="inqType"><label class="label-radio" for="inqType02"><input type="radio" name="inqType" value="2" id="inqType02" class="x-data-inqType"><span>キャッシュカード・トークン</span></label></li>
								<li id="dial03" name="inqType"><label class="label-radio" for="inqType03"><input type="radio" name="inqType" value="3" id="inqType03" class="x-data-inqType"><span>振込</span></label></li>
								<li id="dial04" name="inqType"><label class="label-radio" for="inqType04"><input type="radio" name="inqType" value="4" id="inqType04" class="x-data-inqType"><span>口座自動振替</span></label></li>
								<li id="dial05" name="inqType"><label class="label-radio" for="inqType05"><input type="radio" name="inqType" value="5" id="inqType05" class="x-data-inqType"><span>各種証明書（取引明細・残高証明など）</span></label></li>
								<li id="dial06" name="inqType"><label class="label-radio" for="inqType06"><input type="radio" name="inqType" value="6" id="inqType06" class="x-data-inqType"><span>その他</span></label></li>
								<li id="dial07" name="inqType"><label class="label-radio" for="inqType07"><input type="radio" name="inqType" value="7" id="inqType07" class="x-data-inqType"><span>登録情報の変更</span></label></li>
								<li id="dial08" name="inqType"><label class="label-radio" for="inqType08"><input type="radio" name="inqType" value="8" id="inqType08" class="x-data-inqType"><span>キャッシュカード・トークン</span></label></li>
								<li id="dial09" name="inqType"><label class="label-radio" for="inqType09"><input type="radio" name="inqType" value="9" id="inqType09" class="x-data-inqType"><span>振込</span></label></li>
								<li id="dial10" name="inqType"><label class="label-radio" for="inqType10"><input type="radio" name="inqType" value="10" id="inqType10" class="x-data-inqType"><span>口座自動振替</span></label></li>
								<li id="dial11" name="inqType"><label class="label-radio" for="inqType11"><input type="radio" name="inqType" value="11" id="inqType11" class="x-data-inqType"><span>各種証明書（取引明細・残高証明など）</span></label></li>
								<li id="dial12" name="inqType"><label class="label-radio" for="inqType12"><input type="radio" name="inqType" value="12" id="inqType12" class="x-data-inqType"><span>BA-PLUS</span></label></li>
								<li id="dial13" name="inqType"><label class="label-radio" for="inqType13"><input type="radio" name="inqType" value="13" id="inqType13" class="x-data-inqType"><span>その他</span></label></li>
							</ul>
						</div>
						<p>
							<a href="javascript:void(0);" class="modal__bottomArea btn btn03 btnL">閉じる</a>
						</p>
					</div>
				</div>
			</div>
		</div>
	</div>
	
	<div class="blkCont layout-form layout-form-normal">
		<div class="input-textarea">
			<label for="textInput" class="input-title">お問い合わせ詳細</label>
			<div class="textinput-box">
				<textarea type="text" id="inqTextInput" name="textInput" maxlength="" rows="10" wrap="soft" class="reqEntry" placeholder="ご記入ください" style="overflow: auto;"></textarea>
				<span id="inqContentDel" class="InputClear inputClear" style="margin-right: 16px;">×</span>
			</div>
			<span class="input-message">2000文字以内で入力</span>
			<div id="inqOutputError"></div>
		</div>
	</div>
	
	<div class="blkCont layout-form layout-form-normal">
		<div>
			<p class="input-title">メールアドレス</p>
			<p id="newInqMail"></p>
		</div>
	</div>
	
	<div class="blkCont mt-16">
		<div class="note">
			<p>当社からの回答がお問い合わせフォームに投稿されると、上記の登録メールアドレス宛にお知らせします。回答内容はお問い合わせフォームにログインしてご確認ください。</p>
		</div>
	</div>
	
	<div class="blkCont layout-form layout-form-normal">
		<div class="wrap-input upfile-wrap">
			<label class="input-title">ファイルアップロード（任意）
				<span class="upfileLink">ファイルを選択（24MBまで）</span>
				<input type="file" name="fileName" id="inqFileName" class="dn" multiple="multiple">
				<input type="text" id="inqFileText" name="fileText" value="">
			</label>
			<div id="inqFileAlert" style="font-weight:bold;color:red;"></div>
			<div id="inqFileList"></div>
		</div>
	</div>
	
	<div class="modalWrap_error error-type1">
		<div class="modalOuter_error">
			<div class="modal__headArea"><img src="/commontpl/images/category/contact_error.png" alt="" width="128" height="64"></div>
			<div class="modal__bodyArea">
				<p class="fBold">入力された内容が失われます。<br>それでも問題ない場合は戻るを選択して下さい。</p>
			</div>
			<div class="modal_error_btnArea">
				<p><a href="javascript:void(0);" class="btn btn01 btnL modal__close" onclick="inqClearInput();">戻る</a></p>
				<p><a href="javascript:void(0);" class="btn btn03 btnL modal__close">閉じる</a></p>
			</div>
		</div>
	</div>
	
	<div class="modalWrap_error error-type2">
		<div class="modalOuter_error">
			<div class="modal__headArea">
				<img src="/commontpl/images/category/contact_error.png" alt="" width="128" height="64">
			</div>
			<div class="modal__bodyArea">
				<p class="fBold">入力された内容が失われます。<br>それでも問題ない場合は「削除する」を選択してください。</p>
			</div>
			<div class="modal_error_btnArea">
				<p><a id="inqDelBtn" href="javascript:void(0);" class="btn btn01 btnL modal__close">削除する</a></p>
				<p><a href="javascript:void(0);" class="btn btn03 btnL modal__close">閉じる</a></p>
			</div>
		</div>
	</div>
	
	<div class="modalWrap_error error-type3">
		<div class="modalOuter_error">
			<div class="modal__headArea">
				<img src="/commontpl/images/category/contact_error.png" alt="" width="128" height="64">
			</div>
			<div class="modal__bodyArea">
				<p class="fBold">アップロードしたファイルが削除されます。<br>それでも問題ない場合は「削除する」を選択してください。</p>
			</div>
			<div class="modal_error_btnArea">
				<p><a href="javascript:void(0);" class="btn btn01 btnL modal__close" onclick="inqDeleteFile();">削除する</a></p>
				<p><a href="javascript:void(0);" class="btn btn03 btnL modal__close">閉じる</a></p>
			</div>
		</div>
	</div>
	
	<div class="blkCont contbrd-btnArea-box">
		<p><input id="confButton" type="submit" onclick="outputValueInqConf();" class="btn btn01 btnL" value="確認する"></p>
		<p class="mt-16"><a href="javascript:void(0);" onclick="inqPrevAction();" class="btn btn03 btnL prevBtn">戻る</a></p>
	</div>
</div>

<!-- NewInquiry_ConfirmationScreen -->
<div id="inqConfirmScreen" class="contents no-title-h1" style="display:none;">

	<div class="blk">
		<div class="blkTitle">
			<h2 id="inqConfType" class="h201">お問い合わせ種類</h2>
		</div>
		<div class="blkCont bdrT0">
			<p id="inqConfTypeText"></p>
		</div>
		<div class="blkTitle">
			<h2 id="inqConfDtails" class="h201">お問い合わせ詳細</h2>
		</div>
		<div class="blkCont bdrT0">
			<p id="inqConfDtailsText"></p>
		</div>
		<div class="blkTitle">
			<h2 class="h201">メールアドレス</h2>
		</div>
		<div class="blkCont bdrT0">
			<p id="inqConfMailText"></p>
		</div>
		<div class="blkTitle">
			<h2 class="h201">ファイルアップロード</h2>
			<p id="inqUploadFiles"></p>
		</div>
		<div class="blkCont bdrT0">
			<div class="contbrd-btnArea-box">
				<p><a href="javascript:void(0);" onclick="registInquery();" class="btn btn01 btnL">投稿する</a></p>
				<p class="mt-16"><a href="javascript:void(0);" onclick="changeDisp('inqInputScreen')" class="btn btn03 btnL">戻る</a></p>
			</div>
		</div>
	</div>
</div>

<!-- Reply_InputScreen -->
<div id="replyInputScreen" class="contents no-title-h1 contbrd-pt-cont" style="display:none;">
	<div class="blk">
		<div class="blkCont layout-form layout-form-normal">
			<p class="contbrd-title">投稿内容</p>
			<div class="input-textarea">
				<div class="textinput-box">
					<textarea type="text" id="cbdTextInput" name="textInput" maxlength="" rows="10" wrap="soft" class="reqEntry inputTextItem" placeholder="ご記入ください" style="overflow: auto;"></textarea>
					<span id="cbdContentDel" class="InputClear inputClear" style="margin-right: 16px;">×</span>
				</div>
				<span class="input-message">2000文字以内で入力</span>
				<div id="cbdOutputError"></div>
			</div>
			<div class="blkCont layout-form layout-form-normal">
				<div class="mt-16">
					<div class="wrap-input upfile-wrap">
						<label class="input-title">ファイルアップロード（任意）
							<span class="upfileLink">ファイルを選択（24MBまで）</span>
							<input type="file" name="fileName" id="cbdFileName" class="dn" multiple="multiple">
							<input type="text" id="cbdFileText" name="fileText" value="">
						</label>
						<div id="cbdFileAlert" style="font-weight:bold;color:red;"></div>
						<div id="cbdFileList"></div>
					</div>
				</div>
				<div class="modalWrap_error error-type1">
					<div class="modalOuter_error">
						<div class="modal__headArea">
							<img src="/commontpl/images/category/contact_error.png" alt="" width="128" height="64">
						</div>
						<div class="modal__bodyArea">
							<p class="fBold">入力された内容が失われます。<br>それでも問題ない場合は戻るを選択してください。</p>
						</div>
						<div class="modal_error_btnArea">
							<p><a href="javascript:void(0);" class="btn btn01 btnL modal__close" onclick="cbdClearInput();">戻る</a></p>
							<p><a href="javascript:void(0);" class="btn btn03 btnL modal__close">閉じる</a></p>
						</div>
					</div>
				</div>
				
				<div class="modalWrap_error error-type2">
					<div class="modalOuter_error">
						<div class="modal__headArea">
							<img src="/commontpl/images/category/contact_error.png" alt="" width="128" height="64">
						</div>
						<div class="modal__bodyArea">
							<p class="fBold">入力された内容が失われます。<br>それでも問題ない場合は「削除する」を選択してください。</p>
						</div>
						<div class="modal_error_btnArea">
							<p><a id="cbdDelBtn" href="javascript:void(0);" class="btn btn01 btnL modal__close">削除する</a></p>
							<p><a href="javascript:void(0);" class="btn btn03 btnL modal__close">閉じる</a></p>
						</div>
					</div>
				</div>
				
				<div class="modalWrap_error error-type3">
					<div class="modalOuter_error">
						<div class="modal__headArea">
							<img src="/commontpl/images/category/contact_error.png" alt="" width="128" height="64">
						</div>
						<div class="modal__bodyArea">
							<p class="fBold">アップロードしたファイルが削除されます。<br>それでも問題ない場合は「削除する」を選択してください。</p>
						</div>
						<div class="modal_error_btnArea">
							<p><a href="javascript:void(0);" class="btn btn01 btnL modal__close" onclick="cbdDeleteFile();">削除する</a></p>
							<p><a href="javascript:void(0);" class="btn btn03 btnL modal__close">閉じる</a></p>
						</div>
					</div>
				</div>
				
				<div class="contbrd-btnArea-box">
					<p class="mt-24">
						<input type="submit" id='cbdConfButton' onclick="outputValueCbdConf();" class="btn btn01 btnL" value="確認する" disabled>
					</p>
					<p class="mt-16">
						<a href="javascript:void(0);" onclick="cbdPrevAction();" class="btn btn03 btnL prevBtn">戻る</a>
					</p>
				</div>
			</div>
		</div>
	</div>
</div>

<!-- Reply_ConfirmationScreen -->
<div id="replyConfirmScreen" class="contents no-title-h1 contbrd-pt-cont" style="display:none;">
	<div class="blk">
		<div class="blkCont bdrT0">
			<p class="contbrd-title">投稿内容</p>
			<p id="cbdConfDtailsText"></p>
			<h3 class="h301 mt-24">ファイルアップロード</h3>
			<p id="cbdUploadFiles"></p>
			<div class="contbrd-btnArea-box">
				<p>
					<input type="submit" id="" onclick="registContactBoard();" class="btn btn01 btnL" value="投稿する">
				</p>
				<p class="mt-16">
					<a href="javascript:void(0);" onclick="changeDisp('replyInputScreen')" class="btn btn03 btnL">戻る</a>
				</p>
			</div>
		</div>
	</div>
</div>

<!-- CompletionScreen -->
<div id="compScreen" class="contents no-title-h1 contbrd-pt-cont" style="display:none;">
	<div class="blk">
		<div class="blkCont">
			<p class="compDescription">
				<span class="compDescriptionIcon">受付完了しました</span>
			</p>
		</div>
		<div class="blkCont mt-24">
			<p>受付完了のメールを送信しました。</p>
			<p class="faqLink">
				<a href="https://help.paypay-bank.co.jp/hc/ja/articles/900002658186" target="_blank">メールが届かない場合</a>
			</p>
			<p>当社からの回答は原則翌営業日にメールでお知らせします。回答内容はお問い合わせフォームにログインしてご確認ください。</p>
			<div class="contbrd-btnArea-box">
				<p>
					<input type="submit" id="" onclick="getAllCase(); changeDisp('inquiryForm')" class="btn btn02 btnL" value="お問い合わせフォーム">
				</p>
				<p class="mt-16">
					<input type="submit" id="" class="btn btn03 btnL" value="Welcome Page">
				</p>
			</div>
		</div>
	</div>
</div>

<div class="modalOverlay"></div>

<!-- 通信失敗 -->
<div class="modalWrap_error error-comError">
    <div class="modalOuter_error">
        <div class="modal__headArea"><img src="/commontpl/images/category/contact_error.png" alt="" width="128" height="64"></div>
        <div class="modal__bodyArea">
            <p class="fBold eMessage-comError"></p>
        </div>
        <div class="modal_error_btnArea">
            <p><a href="javascript:void(0);" class="btn btn03 btnL mClose">閉じる</a></p>
        </div>
    </div>
</div>

<!-- 時限チェック -->
<div class="modalWrap_error error-timeoutError">
    <div class="modalOuter_error">
        <div class="modal__headArea"><img src="/commontpl/images/category/contact_error.png" alt="" width="128" height="64"></div>
        <div class="modal__bodyArea">
            <p class="fBold eMessage-error-timeoutError"></p>
        </div>
        <div class="modal_error_btnArea">
            <p><a href="javascript:void(0);" class="btn btn03 btnL mClose">閉じる</a></p>
        </div>
    </div>
</div>

<!-- 異常終了 -->
<div class="modalWrap_error error-abnormalError">
    <div class="modalOuter_error">
        <div class="modal__headArea"><img src="/commontpl/images/category/contact_error.png" alt="" width="128" height="64"></div>
        <div class="modal__bodyArea">
            <p class="fBold eMessage-error-abnormalError"></p>
        </div>
        <div class="modal_error_btnArea">
            <p><a href="javascript:void(0);" class="btn btn03 btnL mClose">閉じる</a></p>
        </div>
    </div>
</div>


<!-- 通信失敗(登録時) -->
<div class="modalWrap_error error-comErrorRegis">
    <div class="modalOuter_error">
        <div class="modal__headArea"><img src="/commontpl/images/category/contact_error.png" alt="" width="128" height="64"></div>
        <div class="modal__bodyArea">
            <p class="fBold eMessage-error-comErrorRegis"></p>
        </div>
        <div class="modal_error_btnArea">
            <p><a href="javascript:void(0);" class="btn btn03 btnL mClose">閉じる</a></p>
        </div>
    </div>
</div>

<!-- メールアドレス不正 -->
<div class="modalWrap_error error-invmailError">
    <div class="modalOuter_error">
        <div class="modal__headArea"><img src="/commontpl/images/category/contact_error.png" alt="" width="128" height="64"></div>
        <div class="modal__bodyArea">
            <p class="fBold eMessage-error-invmailError"></p>
        </div>
        <div class="modal_error_btnArea">
            <p><a href="javascript:void(0);" class="btn btn03 btnL mClose">閉じる</a></p>
        </div>
    </div>
</div>

<!-- 取引先が存在しない -->
<div class="modalWrap_error error-noaccError">
    <div class="modalOuter_error">
        <div class="modal__headArea"><img src="/commontpl/images/category/contact_error.png" alt="" width="128" height="64"></div>
        <div class="modal__bodyArea">
            <p class="fBold eMessage-error-noaccError"></p>
        </div>
        <div class="modal_error_btnArea">
            <p><a href="javascript:void(0);" class="btn btn03 btnL mClose" onclick="changeDisp('noInq')">閉じる</a></p>
        </div>
    </div>
</div>
